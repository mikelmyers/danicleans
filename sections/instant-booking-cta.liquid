{% comment %}
  Instant Booking CTA Bar
  Sticky bottom bar on mobile that follows the user.
  One-tap access to booking. Massive conversion driver on phones.
  Desktop: shows as floating bar at bottom of screen.
{% endcomment %}

{% if section.settings.show_bar %}
<div class="sticky-book-bar" id="stickyBookBar">
  <div class="sticky-book-inner">
    <div class="sticky-book-text">
      <strong>{{ section.settings.text }}</strong>
      {% if section.settings.subtext != blank %}
        <span>{{ section.settings.subtext }}</span>
      {% endif %}
    </div>
    <div class="sticky-book-actions">
      <a href="{{ section.settings.cta_url | default: '/pages/request-a-quote' }}" class="sticky-book-btn book">{{ section.settings.cta_text }}</a>
      <a href="tel:4343510335" class="sticky-book-btn call">Call Now</a>
    </div>
  </div>
</div>
{% endif %}

<style>
.sticky-book-bar {
  position: fixed; bottom: 0; left: 0; right: 0; z-index: 90;
  background: #1a3a2a; color: #fff; padding: 12px 20px;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
  transform: translateY(100%); transition: transform 0.3s ease;
}
.sticky-book-bar.visible { transform: translateY(0); }
.sticky-book-inner {
  max-width: 1100px; margin: 0 auto;
  display: flex; align-items: center; justify-content: space-between;
  gap: 16px; flex-wrap: wrap;
}
.sticky-book-text strong { display: block; font-size: 15px; }
.sticky-book-text span { font-size: 13px; opacity: 0.8; }
.sticky-book-actions { display: flex; gap: 8px; }
.sticky-book-btn {
  padding: 10px 22px; border-radius: 8px; font-size: 14px; font-weight: 700;
  text-decoration: none; transition: all 0.2s; white-space: nowrap;
}
.sticky-book-btn.book { background: #fff; color: #2d6a4f; }
.sticky-book-btn.call { background: transparent; border: 1px solid rgba(255,255,255,0.4); color: #fff; }
@media (max-width: 600px) {
  .sticky-book-inner { justify-content: center; text-align: center; }
  .sticky-book-text { display: none; }
  .sticky-book-actions { width: 100%; }
  .sticky-book-btn { flex: 1; text-align: center; }
}
</style>

<script>
(function() {
  var bar = document.getElementById('stickyBookBar');
  if (!bar) return;
  var shown = false;
  window.addEventListener('scroll', function() {
    if (window.scrollY > 400 && !shown) {
      bar.classList.add('visible');
      shown = true;
    } else if (window.scrollY <= 400 && shown) {
      bar.classList.remove('visible');
      shown = false;
    }
  });
})();
</script>

{% schema %}
{
  "name": "Sticky Booking Bar",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_bar",
      "label": "Show sticky bar",
      "default": true
    },
    {
      "type": "text",
      "id": "text",
      "label": "Main text",
      "default": "Ready for a cleaner home?"
    },
    {
      "type": "text",
      "id": "subtext",
      "label": "Subtext",
      "default": "Free estimates. No contracts."
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "Button text",
      "default": "Book Now"
    },
    {
      "type": "url",
      "id": "cta_url",
      "label": "Button link"
    }
  ]
}
{% endschema %}
